{"ast":null,"code":"var _jsxFileName = \"/Users/ljubomirkolev/Documents/GitHub/BeOurGuest-Homeworks/Homework 4/client/src/components/Map.jsx\";\n//components\nimport React, { Component, useEffect } from 'react';\nimport L from 'leaflet';\nimport 'leaflet-routing-machine';\nimport \"leaflet-routing-machine/dist/leaflet-routing-machine.css\";\nimport { MapContainer, TileLayer, useMap, Marker, Popup } from 'react-leaflet';\nimport Place from './Place';\n\n//styles\nimport '../styles/Map.css';\n\n//custom marker icon\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar userIcon = L.icon({\n  iconUrl: require('../img/markers/marker-icon-red.png'),\n  shadowUrl: require('../img/markers/marker-shadow.png'),\n  iconSize: [25, 41],\n  iconAnchor: [12.5, 41],\n  popupAnchor: [1, -41],\n  shadowSize: [41, 41]\n});\nvar placeIcon = L.icon({\n  iconUrl: require('../img/markers/marker-icon-blue.png'),\n  shadowUrl: require('../img/markers/marker-shadow.png'),\n  iconSize: [25, 41],\n  iconAnchor: [12.5, 41],\n  popupAnchor: [1, -41],\n  shadowSize: [41, 41]\n});\nclass Map extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      location: {\n        lat: 41.9972,\n        lng: 21.4331\n      },\n      zoom: 16,\n      allowedLocation: false,\n      displayed: false,\n      markers: []\n    };\n    this.displayRoute = this.displayRoute.bind(this);\n    this.removeRoute = this.removeRoute.bind(this);\n  }\n\n  /*Called when the page is loaded, if the user denies access through their browser we get their location through their IP address using ipAPI\n    Update the state after the user is located*/\n  componentDidMount() {\n    navigator.geolocation.getCurrentPosition(position => {\n      this.setState({\n        location: {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        },\n        allowedLocation: true\n      });\n    }, async () => {\n      console.log('ERROR: Location access denied! Fetching location based on IP address.');\n      await fetch('https://ipapi.co/json').then(res => res.json()).then(location => {\n        this.setState({\n          location: {\n            lat: location.latitude,\n            lng: location.longitude\n          },\n          allowedLocation: true\n        });\n      });\n    });\n    this.loadMarkers();\n  }\n  async loadMarkers() {\n    const {\n      markers\n    } = this.state;\n    fetch('https://' + process.env.REACT_APP_BASE_URL + '/places/').then(res => res.json()).then(places => this.setState({\n      markers: places\n    }));\n  }\n  displayRoute() {\n    this.setState({\n      displayed: true\n    });\n  }\n  removeRoute() {\n    this.setState({\n      displayed: false\n    });\n  }\n\n  //Map and marker rendering, flying animation when the user is located\n  render() {\n    var _s = $RefreshSig$();\n    const position = [this.state.location.lat, this.state.location.lng];\n    const FlyMapTo = () => {\n      _s();\n      const map = useMap();\n      useEffect(() => {\n        map.flyTo(position);\n      }, [position]);\n      return null;\n    };\n    _s(FlyMapTo, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n      return [useMap];\n    });\n    return /*#__PURE__*/_jsxDEV(MapContainer, {\n      className: \"map\",\n      center: position,\n      zoom: this.state.zoom,\n      scrollWheelZoom: true,\n      zoomControl: false,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), this.state.allowedLocation && /*#__PURE__*/_jsxDEV(Marker, {\n        position: position,\n        icon: userIcon,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: \"Among Us.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 21\n      }, this), this.state.markers && this.state.markers.map(place => {\n        return /*#__PURE__*/_jsxDEV(Place, {\n          userLocation: position,\n          eventLocation: [place.Latitude, place.Longtitude],\n          eventOrg: place.Name,\n          eventId: place._id,\n          displayRoute: this.displayRoute,\n          removeRoute: this.removeRoute,\n          value: this.state.displayed\n        }, place._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 29\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(FlyMapTo, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this);\n  }\n}\nexport default Map;","map":{"version":3,"names":["React","Component","useEffect","L","MapContainer","TileLayer","useMap","Marker","Popup","Place","userIcon","icon","iconUrl","require","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","placeIcon","Map","constructor","props","state","location","lat","lng","zoom","allowedLocation","displayed","markers","displayRoute","bind","removeRoute","componentDidMount","navigator","geolocation","getCurrentPosition","position","setState","coords","latitude","longitude","console","log","fetch","then","res","json","loadMarkers","process","env","REACT_APP_BASE_URL","places","render","FlyMapTo","map","flyTo","place","Latitude","Longtitude","Name","_id"],"sources":["/Users/ljubomirkolev/Documents/GitHub/BeOurGuest-Homeworks/Homework 4/client/src/components/Map.jsx"],"sourcesContent":["//components\nimport React, { Component, useEffect} from 'react';\nimport L from 'leaflet';\nimport 'leaflet-routing-machine';\nimport \"leaflet-routing-machine/dist/leaflet-routing-machine.css\";\nimport { MapContainer, TileLayer, useMap, Marker, Popup } from 'react-leaflet'\nimport Place from './Place';\n\n//styles\nimport '../styles/Map.css';\n\n//custom marker icon\nvar userIcon = L.icon({\n    iconUrl:  require('../img/markers/marker-icon-red.png'),\n    shadowUrl: require('../img/markers/marker-shadow.png'),\n    iconSize: [25, 41],\n    iconAnchor: [12.5, 41],\n    popupAnchor: [1, -41],\n    shadowSize: [41, 41]\n});\n\nvar placeIcon = L.icon({\n    iconUrl:  require('../img/markers/marker-icon-blue.png'),\n    shadowUrl: require('../img/markers/marker-shadow.png'),\n    iconSize: [25, 41],\n    iconAnchor: [12.5, 41],\n    popupAnchor: [1, -41],\n    shadowSize: [41, 41]\n});\n\nclass Map extends Component {\n    constructor(props) {\n        super(props);\n    \n        this.state = {\n            location: {\n                lat: 41.9972,\n                lng: 21.4331,\n            },\n            zoom: 16,\n            allowedLocation: false,\n            displayed: false,\n            markers:[]\n        }\n        this.displayRoute = this.displayRoute.bind(this);\n        this.removeRoute = this.removeRoute.bind(this);\n    }\n\n    /*Called when the page is loaded, if the user denies access through their browser we get their location through their IP address using ipAPI\n      Update the state after the user is located*/\n    componentDidMount() {\n        navigator.geolocation.getCurrentPosition((position) => {\n            this.setState({\n                location: {\n                    lat: position.coords.latitude,\n                    lng: position.coords.longitude\n                },\n                allowedLocation: true\n            });\n        },async  () => {\n            console.log('ERROR: Location access denied! Fetching location based on IP address.');\n            await fetch('https://ipapi.co/json')\n                .then(res => res.json())\n                .then(location => {\n                    this.setState({\n                        location: {\n                            lat: location.latitude,\n                            lng: location.longitude\n                        },\n                        allowedLocation: true\n                    });\n                });\n        });\n        this.loadMarkers();\n    }\n\n    async loadMarkers(){\n        const {markers} = this.state\n        fetch('https://'+process.env.REACT_APP_BASE_URL+'/places/')\n        .then(res=>res.json())\n        .then(places=>this.setState({markers:places}))\n    }\n\n    displayRoute() {\n        this.setState({\n            displayed: true\n        });\n    }\n    removeRoute() {\n        this.setState({\n            displayed: false\n        });\n    } \n\n    //Map and marker rendering, flying animation when the user is located\n    render() {\n        const position = [this.state.location.lat, this.state.location.lng];\n        \n        const FlyMapTo = () => {\n            const map = useMap()\n        \n            useEffect(() => {\n                map.flyTo(position)\n            }, [position])\n\n            return null\n        }\n\n        return (\n            <MapContainer className='map' center={position} zoom={this.state.zoom} scrollWheelZoom={true} zoomControl={false}>\n                <TileLayer\n                    attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                />\n                { this.state.allowedLocation &&\n                    <Marker position={position} icon={userIcon}>\n                        <Popup>\n                            Among Us.\n                        </Popup>\n                    </Marker> \n                }\n                {   this.state.markers &&\n                    this.state.markers.map(place=>{\n                        return(\n                            <Place key={place._id}\n                            userLocation={position} \n                            eventLocation={[place.Latitude, place.Longtitude]}\n                            eventOrg={place.Name}\n                            eventId={place._id}\n                            displayRoute={this.displayRoute}\n                            removeRoute={this.removeRoute}\n                            value={this.state.displayed}\n                        />\n                        )\n                    })\n                }\n                <FlyMapTo />\n            </MapContainer>\n        );\n    }\n}\n\nexport default Map"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}